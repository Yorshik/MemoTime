{% extends "base.html" %}
{% load i18n static %}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'icons/bootstrap-icons.css' %}">
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
  <link rel="stylesheet" href="{% static 'css/popup.css' %}">
{% endblock extra_css %}
{% block body %}
  <div class="login-container d-flex align-items-center justify-content-center py-5">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-md-8 col-lg-6 col-xl-5">
          <div class="glass-card p-4 p-md-5 animate-appear">
            <div class="text-center mb-4">
              <h1 class="login-brand mb-4">
                {% block form_title %}
                {% endblock form_title %}
              </h1>
              {% block form_description %}
              {% endblock form_description %}
            </div>
            {% if messages %}
              {% for message in messages %}
                <div class="{% if message.tags == 'success' %}success-message{% elif message.tags == 'error' %}error-message{% endif %}">
                  {{ message }}
                </div>
              {% endfor %}
            {% endif %}
            {% if form.errors and not form.non_field_errors %}
              <div class="error-message">
                {% blocktranslate count counter=form.errors.items|length %}
                  Пожалуйста, исправьте ошибку ниже.
                {% plural %}
                  Пожалуйста, исправьте ошибки ниже.
                {% endblocktranslate %}
              </div>
            {% endif %}
            {% if form.non_field_errors %}
              {% for error in form.non_field_errors %}<div class="error-message">{{ error }}</div>{% endfor %}
            {% endif %}
            <form method="post"
                  {% if form.is_multipart %}enctype="multipart/form-data"{% endif %}
                  class="needs-validation animate"
                  novalidate>
              {% csrf_token %}
              {% block form_hidden_fields %}
              {% endblock form_hidden_fields %}
              {% block form_fields %}
                {% for field in form.visible_fields %}
                  {% if field.name == 'captcha' %}
                    {{ field.as_widget }}
                  {% else %}
                    <div class="form-floating mb-3">
                      <div class="form-floating">
                        {{ field }}
                        <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                        {% block field_icon %}
                          {% if field.name == 'username' %}
                            <i class="bi bi-person input-icon"></i>
                         {% elif field.name == 'email' %}
                            <i class="bi bi-envelope input-icon"></i>
                          {% elif 'password' in field.name %}
                            <i class="bi bi-lock input-icon"></i>
                          {% endif %}
                        {% endblock field_icon %}
                      </div>
                      {% if field.errors %}<div class="invalid-feedback d-block">{{ field.errors }}</div>{% endif %}
                      {% if field.help_text %}<small class="form-text text-muted">{{ field.help_text }}</small>{% endif %}
                    </div>
                  {% endif %}
                {% endfor %}
              {% endblock form_fields %}
              <div class="d-grid mb-4">
                <button type="submit" class="btn btn-primary btn-lg">
                  {% block submit_button_text %}
                    {% trans 'Отправить' %}
                  {% endblock submit_button_text %}
                </button>
              </div>
              {% block form_footer %}
              {% endblock form_footer %}
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock body %}
{% block extra_js %}
  <script src="{% static 'js/forms.js' %}"></script>
  <script src="{% static 'js/popups.js' %}"></script>
{% endblock extra_js %}
